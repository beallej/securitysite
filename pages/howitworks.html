<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>How it Works</title>
  <meta name="description"content="Vulnerabilites">
  <meta name="author"content="Chet Aldrich and Josie Bealle">
  <style>
      .button{
        text-align: center;
      }
  </style>
  <link rel="stylesheet"href="../css/bootstrap.min.css">
   
</head>

<body>
<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button"class="navbar-toggle"data-toggle="collapse"data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand"href="../index.html">ShellShock </a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="sources.html">Sources</a></li>
            </ul>
        </div><!--/.navbar-collapse -->
      </div>
    </div>

    <div class="jumbotron">
      <div class="container">
        <h1>How ShellShock Works</h1>
        <p>Nuts and Bolts</p>
      </div>
    </div>
       
    <div class="container">
        <div class = "row"> 
        <h2>What is Bash, anyway?</h2>
        <p>Bash (Bourne Again Shell) is a program that is often packaged with UNIX that allows UNIX based systems to execute command lines and scripts.</p>
        <h2>How is the bug exploited?</h2>
        <p>We'll begin with a magical incantation (courtesy of Fedora Magazine):</p>
        <pre>env x='() { :;}; echo OOPS' bash -c :</pre>
        <p>This likely doesn't make too much sense, but examining the components of the test will show what is actually happening when the exploit is used on a victim. 
        So, what exactly is the env at the beginning of the command?</p>
        <p>The env at the beginning simply runs a command given a certain variable set. Not bad, right?</p>
        <p>However, you've probably heard that this bash bug has something to do with environment variables, so you're not convinced. You'd be right. However, in order to understand the command we need to look at function definitions in bash.</p>
        <p>Since bash is a scripting language, we can define functions. For example, say we wanted to find Batman:</p>
        <pre>$ batsignal() { echo '
::: :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
::: :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
::: :::::::::::::::::::::::::::::::::::::::::::::./    \.::::::::::::::::::
::: ::::::::::::::::::::::::::::::::::::::::::./          \::::::::::::::::
::: :::::::::::::::::::::::::::::::::::::::-  /   /\_M_/\  \:::::::::::::::
::: :::::::::::::::::::::::::::::::::::-         |       |  :::::::::::::::
::: ::::::::::::::::::::::::::::::::-         .   \/-V-\/  ,:::::::::::::::
::: ::::::::::::::::::::::::::::-              .          ,::::::::::::::::
::: :::::::::::::::::::::::::-                  `..    ..::::::::::::::::::
::: :::::::::::::::::::::-                   _,,-::::::::::::::::::::::::::
::: ::::::::::::::::::-                 _,--:::::::::::::::::::::::::::::::
::: ::::::::::::::-                _.--::::::::::::::::::::::#####:::::::::
::: :::::::::::-              _.--:::::::::::::::::::::::::::#####:::::####
::: ::::::::     ##     ###.-::::::###:::::::::::::::::::::::#####:::::####
::: ::::-        ###_.::######:::::###::::::::::::::#####:##########:::####
::: :          .:###::########:::::###::::::::::::::#####:##########:::####
:::      ...--:::###::########:::::###:::::######:::#####:##########:::####
:::  _.--:::##:::###:#########:::::###:::::######:::#####:#################
::: ##########:::###:#########::#########::######:::#####:#################
::: :#########:::#############::#########::######:::#######################
::: ##########:::########################::################################
::: ##########:::##########################################################
::: ##########:::##########################################################
::: #######################################################################
::: #######################################################################
::: #######################################################################
::: #######################################################################
'; }</pre>
        <p>This function essentially just stores the command and then executes the contents when prompted with the batsignal command. Note, however, that this <b>STORES</b> the command, but doesn't execute it until called, like so:</p>
        <pre>$ batsignal</pre>
        <p>So this is pretty cool. Now let's just suppose for a moment that I want to execute this in a new instance of bash. The below is what I'm going to end up with:</p>
        <pre>Chets-Air:Desktop chetaldrich$ bash -c batsignal
             bash: batsignal: command not found</pre>
        <p>Using <pre>bash -c</pre> is creating a new instance of bash in which to run the command. Unfortunately, I didn't signal for Batman. This is because the function definition was not inheritied by the new instance of bash. However, the new instance of bash <b>DOES</b> inherit the environment from the previous instance.</p>
        <p>So let's suppose now that we wanted to export our function to the other instance of bash. This can be accomplished with the following commands:</p>
        <pre>$ export -f batsignal
             $ bash -c batsignal</pre>
        <p>Now, in concept, this should be just fine. However, the way this is actually done in implementation is somewhat sketchy. Since Linux/Unix systems don't have a special way to create function definitions as environment variables, the new instance of bash just looks through the environment variables. If it parses something that fits its criteria for being a function, it evaluates it. </p>
        <p>Again, in theory even this is safe, since defining a function doesn't mean that we actually execute anything.</p>
        <p>However, we're not safe here, because there was a bug in the code. The evaluation wouldn't just top when the function definition was finished. It kept going.</p>

 </div>
</div>
    <div class = "button">
        <p><a class="btn btn-primary btn-lg" href = "vulnerability.html" role="button">What could this compromise? &raquo;</a></p>
    </div>
</body>
</html>




